import{A as V}from"./entry.3f1e6d9b.js";function b(r,e){const a=[],n=e.resolveKeyData||(o=>o.key),t=e.resolveValueData||(o=>o.value);for(const[o,i]of Object.entries(r))a.push(...(Array.isArray(i)?i:[i]).map(f=>{const l={key:o,value:f},s=t(l);return typeof s=="object"?b(s,e):Array.isArray(s)?s:{[typeof e.key=="function"?e.key(l):e.key]:n(l),[typeof e.value=="function"?e.value(l):e.value]:s}}).flat());return a}function h(r,e){return Object.entries(r).map(([a,n])=>{if(typeof n=="object"&&(n=h(n,e)),e.resolve){const t=e.resolve({key:a,value:n});if(t)return t}return typeof n=="number"&&(n=n.toString()),typeof n=="string"&&e.wrapValue&&(n=n.replace(new RegExp(e.wrapValue,"g"),`\\${e.wrapValue}`),n=`${e.wrapValue}${n}${e.wrapValue}`),`${a}${e.keyValueSeparator||""}${n}`}).join(e.entrySeparator||"")}const c=r=>({keyValue:r,metaKey:"property"}),p=r=>({keyValue:r}),m={appleItunesApp:{unpack:{entrySeparator:", ",resolve({key:r,value:e}){return`${u(r)}=${e}`}}},articleExpirationTime:c("article:expiration_time"),articleModifiedTime:c("article:modified_time"),articlePublishedTime:c("article:published_time"),bookReleaseDate:c("book:release_date"),charset:{metaKey:"charset"},contentSecurityPolicy:{unpack:{entrySeparator:"; ",resolve({key:r,value:e}){return`${u(r)} ${e}`}},metaKey:"http-equiv"},contentType:{metaKey:"http-equiv"},defaultStyle:{metaKey:"http-equiv"},fbAppId:c("fb:app_id"),msapplicationConfig:p("msapplication-Config"),msapplicationTileColor:p("msapplication-TileColor"),msapplicationTileImage:p("msapplication-TileImage"),ogAudioSecureUrl:c("og:audio:secure_url"),ogAudioUrl:c("og:audio"),ogImageSecureUrl:c("og:image:secure_url"),ogImageUrl:c("og:image"),ogSiteName:c("og:site_name"),ogVideoSecureUrl:c("og:video:secure_url"),ogVideoUrl:c("og:video"),profileFirstName:c("profile:first_name"),profileLastName:c("profile:last_name"),profileUsername:c("profile:username"),refresh:{metaKey:"http-equiv",unpack:{entrySeparator:";",keyValueSeparator:"=",resolve({key:r,value:e}){if(r==="seconds")return`${e}`}}},robots:{unpack:{entrySeparator:", ",resolve({key:r,value:e}){return typeof e=="boolean"?`${u(r)}`:`${u(r)}:${e}`}}},xUaCompatible:{metaKey:"http-equiv"}},$=["og","book","article","profile"];function A(r){var a;const e=u(r).split(":")[0];return $.includes(e)?"property":((a=m[r])==null?void 0:a.metaKey)||"name"}function _(r){var e;return((e=m[r])==null?void 0:e.keyValue)||u(r)}function u(r){const e=r.replace(/([A-Z])/g,"-$1").toLowerCase(),a=e.split("-")[0];return $.includes(a)||a==="twitter"?r.replace(/([A-Z])/g,":$1").toLowerCase():e}function y(r){if(Array.isArray(r))return r.map(a=>y(a));if(typeof r!="object"||Array.isArray(r))return r;const e={};for(const[a,n]of Object.entries(r))e[u(a)]=y(n);return e}function j(r,e){const a=m[e];return e==="refresh"?`${r.seconds};url=${r.url}`:h(y(r),{entrySeparator:", ",resolve({value:n,key:t}){if(n===null)return"";if(typeof n=="boolean")return`${t}`},...a==null?void 0:a.unpack})}const S=["og:image","og:video","og:audio","twitter:image"];function K(r){const e={};return Object.entries(r).forEach(([a,n])=>{String(n)!=="false"&&a&&(e[a]=n)}),e}function d(r,e){const a=K(e),n=u(r),t=A(n);if(S.includes(n)){const o={};return Object.entries(a).forEach(([i,f])=>{o[`${r}${i==="url"?"":`${i.charAt(0).toUpperCase()}${i.slice(1)}`}`]=f}),g(o).sort((i,f)=>{var l,s;return(((l=i[t])==null?void 0:l.length)||0)-(((s=f[t])==null?void 0:s.length)||0)})}return[{[t]:n,...a}]}function g(r){const e=[],a={};Object.entries(r).forEach(([t,o])=>{if(!Array.isArray(o)){if(typeof o=="object"&&o){if(S.includes(u(t))){e.push(...d(t,o));return}a[t]=K(o)}else a[t]=o;return}o.forEach(i=>{e.push(...typeof i=="string"?g({[t]:i}):d(t,i))})});const n=b(a,{key({key:t}){return A(t)},value({key:t}){return t==="charset"?"charset":"content"},resolveKeyData({key:t}){return _(t)},resolveValueData({value:t,key:o}){return t===null?"_null":typeof t=="object"?j(t,o):typeof t=="number"?t.toString():t}});return[...e,...n].map(t=>(t.content==="_null"&&(t.content=null),t))}function T(r,e){const{title:a,titleTemplate:n,...t}=r;return V({title:a,titleTemplate:n,_flatMeta:t},{...e,transform(o){const i=g({...o._flatMeta});return delete o._flatMeta,{...o,meta:i}}})}export{T as u};
